import { Extension, JSONContent, Extensions } from '@tiptap/core';
import { Node } from '@tiptap/pm/model';
import { Transaction } from '@tiptap/pm/state';

type UniqueIDGenerationContext = {
    node: Node;
    pos: number;
};
interface UniqueIDOptions {
    /**
     * The name of the attribute to add the unique ID to.
     * @default "id"
     */
    attributeName: string;
    /**
     * The types of nodes to add unique IDs to.
     * @default []
     */
    types: string[];
    /**
     * The function that generates the unique ID. By default, a UUID v4 is
     * generated. However, you can provide your own function to generate the
     * unique ID based on the node type and the position.
     */
    generateID: (ctx: UniqueIDGenerationContext) => any;
    /**
     * Ignore some mutations, for example applied from other users through the collaboration plugin.
     *
     * @default null
     */
    filterTransaction: ((transaction: Transaction) => boolean) | null;
    /**
     * Whether to update the document by adding unique IDs to the nodes. Set this
     * property to `false` if the document is in `readonly` mode, is immutable, or
     * you don't want it to be modified.
     *
     * @default true
     */
    updateDocument: boolean;
}
declare const UniqueID: Extension<UniqueIDOptions, any>;

/**
 * Creates a new document with unique IDs added to the nodes. Does the same
 * thing as the UniqueID extension, but without the need to create an `Editor`
 * instance. This lets you add unique IDs to the document in the server.
 *
 * When you call it, include the `UniqueID` extension in the `extensions` array.
 * The configuration from the `UniqueID` extension will be picked up
 * automatically, including its configuration options like `types` and
 * `attributeName`.
 *
 * @see `UniqueID` extension for more information.
 *
 * @throws {Error} If the `UniqueID` extension is not found in the extensions array.
 *
 * @example
 * const doc = {
 *   type: 'doc',
 *   content: [
 *     { type: 'paragraph', content: [{ type: 'text', text: 'Hello, world!' }] }
 *   ]
 * }
 * const newDoc = addUniqueIds(doc, [StarterKit, UniqueID.configure({ types: ['paragraph', 'heading'] })])
 * console.log(newDoc)
 * // Result:
 * // {
 * //   type: 'doc',
 * //   content: [
 * //     { type: 'paragraph', content: [{ type: 'text', text: 'Hello, world!' }], id: '123' }
 * //   ]
 * // }
 *
 * @param doc - A Tiptap JSON document to add unique IDs to.
 * @param extensions - The extensions to use. Must include the `UniqueID` extension.
 * @returns The updated Tiptap JSON document, with the unique IDs added to the nodes.
 */
declare function generateUniqueIds(doc: JSONContent, extensions: Extensions): JSONContent;

export { UniqueID, type UniqueIDGenerationContext, type UniqueIDOptions, UniqueID as default, generateUniqueIds };
